<html>
<head></head>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
    <script lang="js">
        
        async function run() {
    const trainingUrl = '/data/wdbc-train.csv';
    const testingUrl = '/data/wdbc-test.csv';

    // Parse the training data
    const trainingData = tf.data.csv(trainingUrl, {
        columnConfigs: {
            diagnosis: {isLabel: true} // Specify the label column
        }
    });

    // Convert the training data into tensors
    const convertedTrainingData = trainingData.map(({xs, ys}) => {
        return {
            xs: Object.values(xs).map(x => parseFloat(x)), // Convert features to floats
            ys: Object.values(ys) // Convert labels
        };
    }).batch(32); // Batch size

    // Parse the testing data
    const testingData = tf.data.csv(testingUrl, {
        columnConfigs: {
            diagnosis: {isLabel: true} // Specify the label column
        }
    });

    // Convert the testing data into tensors
    const convertedTestingData = testingData.map(({xs, ys}) => {
        return {
            xs: Object.values(xs).map(x => parseFloat(x)), // Convert features to floats
            ys: Object.values(ys) // Convert labels
        };
    }).batch(32); // Batch size

    // Specify the number of features
    const numOfFeatures = (await trainingData.take(1).toArray())[0].xs.length;

    // Build the model
    const model = tf.sequential();
    model.add(tf.layers.dense({inputShape: [numOfFeatures], units: 16, activation: 'relu'}));
    model.add(tf.layers.dense({units: 8, activation: 'relu'}));
    model.add(tf.layers.dense({units: 1, activation: 'sigmoid'})); // Binary output

    // Compile the model
    model.compile({
        optimizer: tf.train.rmsprop(),
        loss: 'binaryCrossentropy',
        metrics: ['accuracy']
    });

    // Train the model
    await model.fitDataset(convertedTrainingData, {
        epochs: 100,
        validationData: convertedTestingData,
        callbacks: {
            onEpochEnd: async (epoch, logs) => {
                console.log(`Epoch: ${epoch}, Loss: ${logs.loss}, Accuracy: ${logs.acc}`);
            }
        }
    });

    // Save the model
    await model.save('downloads://my_model');
}

run();

    </script>
<body>
</body>
</html>
